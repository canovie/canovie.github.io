<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>cloud-native on é’äº‘å·</title>
    <link>https://mydream.ink/categories/cloud-native/</link>
    <description>Recent content in cloud-native on é’äº‘å·</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <lastBuildDate>Wed, 06 Jan 2021 15:00:43 +0800</lastBuildDate><atom:link href="https://mydream.ink/categories/cloud-native/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Pyflink in Kubernetes</title>
      <link>https://mydream.ink/posts/cloud-native/kubernetes/pyflink-in-kubernetes/</link>
      <pubDate>Wed, 06 Jan 2021 15:00:43 +0800</pubDate>
      
      <guid>https://mydream.ink/posts/cloud-native/kubernetes/pyflink-in-kubernetes/</guid>
      <description>pyFlink on kubernetes  åœ¨ TKE ç¯å¢ƒä¸‹
 å‡†å¤‡å·¥ä½œ ä¸º flink åˆ›å»ºä¸“ç”¨çš„å‘½åç©ºé—´ã€ServiceAccountï¼Œå¹¶è®¾ç½®å¥½èµ„æºé…é¢
kubectl create ns flink kubectl -n flink create sa flink kubectl -n flink create role flink --verb=* --resource=*.* kubectl -n flink create rolebinding flink --role=flink --serviceaccount=flink:flink cat &amp;lt;&amp;lt; EOF &amp;gt; apiserver.crt # base é›†ç¾¤ apiserver è¯ä¹¦ -----BEGIN CERTIFICATE----- MIICyDCCAbCgAwIBAgIBADANBgkqhkiG9w0BAQsFADAVMRMwEQYDVQQDEwprdWJl cm5ldGVzMB4XDTIwMDMwNTA4MjYzOFoXDTMwMDMwMzA4MjYzOFowFTETMBEGA1UE AxMKa3ViZXJuZXRlczCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMq/ 6ae6qIZbchBK7b0AaP2714K+tuxtGnl7p3yNwlCgVEnZjfytAr8cvkIzxCBH8xBc vqV2vtDOy0r6HecbIPTkd0bGn6BXjqPp6XZY0ffFgyBhGv6/DD7x7aJIG+A8uSVk /yTGcahGQ9WOQ6CDWDjZvC+K9zkeNqhtj1wm9P/hQcECAQkQbkIqLUF/P8SF4b8N QlodYsrZIg9MDqgQDq744AoFPm/F6G2GfHs1DfesYMoSYQs6ECec0+N/Nf5Kx7XX KW+ARAGEZxC3X7bJmxWr5JSRmmS46rmrN/MUDpMBaWUwtxubVxtIwt1FIFlFqCYz MR9UtvZkTaL6oSd6Q18CAwEAAaMjMCEwDgYDVR0PAQH/BAQDAgKUMA8GA1UdEwEB /wQFMAMBAf8wDQYJKoZIhvcNAQELBQADggEBABXd9WbwOlhlqyFsr/2s9wgf86+/ oo05gZhybHtuKHYvSwzoxAeyaMFGn4b7S2okcLoo3EwjmAN2Pup/qhTtiqM9xNfa +GuN+NX4zjkra+T2NEywIykwhodaFiYB+r6xM0LIHANlKKT7kRtgzkq/s8ui6Wkt b94T8BpE5U3f6YGz/4NtbqpYS6XVjIIjfP5MxoHRCh8H2LXmWs9A2RlmuZAwo0M2 FJjxcfIgvHrgCerPogVcXYT23BavOhMFlx7Jck2GAbDg0HYTabZuLNkj9T1//raL aknXJxuLYHbZe6I1cbsIdXJjav5c83YgqGDKetcJdkQqMgk8lVWW7RIdLb0= -----END CERTIFICATE----- EOF kubectl config --kubeconfig=flink-kubeconfig set-cluster base --server=https://cls-xxxxxxx.</description>
    </item>
    
    <item>
      <title>è®°ä¸€æ¬¡ IPVS å¼•èµ·çš„ kubernetes æœåŠ¡å¼‚å¸¸</title>
      <link>https://mydream.ink/posts/cloud-native/kubernetes/record-a-kubernetes-service-exception-caused-by-ipvs/</link>
      <pubDate>Sun, 06 Dec 2020 17:14:02 +0800</pubDate>
      
      <guid>https://mydream.ink/posts/cloud-native/kubernetes/record-a-kubernetes-service-exception-caused-by-ipvs/</guid>
      <description>é—®é¢˜æè¿° åœ¨æˆ‘ä»¬çš„ç¯å¢ƒä¸­ï¼Œä¸šåŠ¡ A ä¼šè®¿é—®ä¸šåŠ¡ Bï¼ˆä¹Ÿå³ B æ˜¯ A çš„ä¸Šæ¸¸æœåŠ¡ï¼‰ï¼Œå½“ B å‘ç‰ˆæ—¶ï¼ŒA çš„è¯·æ±‚å¶å°”ä¼šå‡ºç° timeoutã€‚ç°è±¡çœ‹èµ·æ¥æ˜¯æµé‡è·¯ç”±åˆ°äº†å·²ç»ä¸èƒ½æä¾›æœåŠ¡çš„è€çš„ pod ä¸­ã€‚
é—®é¢˜å¤„ç† æ’æŸ¥ç‚¹ä¸€ å½“ pod ä¸‹çº¿æ—¶ï¼Œendpoint controller æœªåŠæ—¶å°† pod ä» endpoint ä¸­å–å‡ºï¼Œå¯¼è‡´æµé‡è¿›å…¥äº†æ—§çš„ podã€‚
ç”±äºé›†ç¾¤ master æ˜¯æ‰˜ç®¡éƒ¨ç½²çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ²¡æœ‰åŠæ³•æŸ¥çœ‹ç›¸å…³æ—¥å¿—å’Œè´Ÿè½½ï¼Œæ±‚åŠ©äºè…¾è®¯äº‘çš„åŒæ—¶ï¼Œè‡ªå·±è¿™è¾¹ä¹Ÿåœ¨æ’æŸ¥ã€‚æ’æŸ¥åˆ†ä¸¤æ­¥è¿›è¡Œï¼Œç›‘æ§æœåŠ¡ B endpoint çš„å˜åŒ–ï¼ŒåŒæ—¶æ»šåŠ¨é‡å¯è¯¥æœåŠ¡ã€‚
  ç›‘æ§ ep å˜åŒ–
watch -n 1 kubectl -n production describe ep wk-dispatcher   é‡å¯æœåŠ¡
kubectl -n production rollout restart deployment wk-dispatcher   é€šè¿‡æ’æŸ¥å‘ç°ï¼Œè·Ÿ endpoint controller å¹¶æ²¡æœ‰å…³ç³»ï¼Œå› ä¸º ep å˜åŒ–å¾ˆåŠæ—¶ï¼ŒåŠ ä¸Šè‡³å°‘ 30 ç§’çš„ä¼˜é›…ç»ˆæ­¢æ—¶é—´ï¼ŒåŸºæœ¬å¯ä»¥ç¡®å®šåœ¨æœåŠ¡ç»“æŸå‰ï¼Œpod æ˜¯ä» ep ä¸­ç§»é™¤äº†çš„ã€‚</description>
    </item>
    
    <item>
      <title>ä½¿ç”¨ cert-manager è‡ªåŠ¨ç®¡ç† tls è¯ä¹¦</title>
      <link>https://mydream.ink/posts/cloud-native/kubernetes/use-cert-manager-in-kubernetes/</link>
      <pubDate>Sat, 09 Nov 2019 08:49:39 +0800</pubDate>
      
      <guid>https://mydream.ink/posts/cloud-native/kubernetes/use-cert-manager-in-kubernetes/</guid>
      <description>http åè®®æ˜¯ä¸€ä¸ªå…¨æ˜æ–‡ä¼ è¾“çš„åè®®ï¼Œä¸åŠ ä»»ä½•å¤„ç†çš„ http æŠ¥æ–‡å°†åœ¨å› ç‰¹ç½‘ä¸­è£¸å¥”ï¼Œåªè¦æœ‰äººå¯¹ç›‘å¬ä½ çš„æŠ¥æ–‡ï¼Œä½ æ‰€æœ‰éšç§å°†è¢«äººä¸€è§ˆæ— ä½™ã€‚Letâ€™s Encrypt æ˜¯ä¸€å®¶å…è´¹ã€å¼€æ”¾ã€è‡ªåŠ¨åŒ–çš„è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰ï¼Œä¸ºå…¬ä¼—çš„åˆ©ç›Šè€Œè¿è¡Œã€‚å®ƒæ˜¯ä¸€é¡¹ç”± Internet Security Research Groupï¼ˆISRGï¼‰æä¾›çš„æœåŠ¡ã€‚æœ¬ç€æƒ³è¦åˆ›å»ºä¸€ä¸ªæ›´å®‰å…¨ï¼Œæ›´å°Šé‡éšç§çš„ Web ç¯å¢ƒçš„åˆè¡·ï¼ŒLetâ€™s Encrypt ä»¥å°½å¯èƒ½å¯¹ç”¨æˆ·å‹å¥½çš„æ–¹å¼å…è´¹æä¾›ä¸ºç½‘ç«™å¯ç”¨ HTTPSï¼ˆSSL/TLSï¼‰æ‰€éœ€çš„æ•°å­—è¯ä¹¦ã€‚
ä½†æ˜¯ Letâ€™s Encrypt é¢å‘çš„è¯ä¹¦æœ‰ä¸ªç‰¹ç‚¹ï¼Œæœ‰æ•ˆæœŸåªæœ‰ä¸‰ä¸ªæœˆã€‚è¿™æ„å‘³ç€æˆ‘ä»¬éœ€è¦é¢‘ç¹ç»­æœŸè¯ä¹¦ï¼Œå€˜è‹¥æ‰‹åŠ¨ç»­æœŸï¼Œæ— ç–‘ä¼šå¢åŠ è¿ç»´æˆæœ¬ã€‚æœ‰ä»€ä¹ˆæ–¹å¼å¯ä»¥ä¸ºæˆ‘ä»¬è‡ªåŠ¨é¢å‘è¯ä¹¦å—ï¼Ÿå½“ç„¶æœ‰ï¼ACME æ— ç–‘å°±æ˜¯æˆ‘ä»¬çš„æœ€ä½³é€‰æ‹©ã€‚
æœ‰ä¸€æ¬¾å¾ˆå¥½ç”¨çš„ ACME å®¢æˆ·ç«¯å« Certbotï¼Œå¯ä»¥å¸®åŠ©è‡ªåŠ¨é¢å‘ã€ç»­æœŸè¯ä¹¦ã€‚åœ¨ kubernetes çš„ç”Ÿæ€ä¸­æœ‰æ²¡æœ‰ä»€ä¹ˆå¥½çš„å·¥å…·èƒ½å¸®åŠ©æˆ‘ä»¬éå¸¸æ–¹ä¾¿åœ°ä½¿ç”¨è¯ä¹¦ä¹ˆï¼Ÿå½“ç„¶æœ‰ï¼Œé‚£å°±æ˜¯æœ¬æœŸä¸»é¢˜â€”â€”cert-managerã€‚
cert-manager æ˜¯æœ¬åœ° Kubernetes è¯ä¹¦ç®¡ç†æ§åˆ¶å™¨ã€‚å®ƒå¯ä»¥å¸®åŠ©ä»å„ç§æ¥æºé¢å‘è¯ä¹¦ï¼Œä¾‹å¦‚ Let&amp;rsquo;s Encryptï¼ŒHashiCorp Vaultï¼ŒVenafiï¼Œç®€å•çš„ç­¾åå¯†é’¥å¯¹æˆ–è‡ªç­¾åã€‚å®ƒå°†ç¡®ä¿è¯ä¹¦æœ‰æ•ˆå¹¶ä¸”æ˜¯æœ€æ–°çš„ï¼Œå¹¶åœ¨åˆ°æœŸå‰å°è¯•åœ¨é…ç½®çš„æ—¶é—´ç»­è®¢è¯ä¹¦ã€‚
åŸç†æ¯”è¾ƒç®€å•ï¼Œæœ¬æ–‡å°±ä¸è®²äº†ï¼Œä¸»è¦è°ˆè°ˆæ¥å®‰è£…å’Œä½¿ç”¨ã€‚
å®‰è£… YAML å®‰è£…   åˆ›å»º namespace
kubectl create namespace cert-manager   å®‰è£… crd å’Œ cert-manager
kubectl apply -f https://github.com/jetstack/cert-manager/releases/download/v0.11.0/cert-manager.yaml  å€¼å¾—è¯´æ˜çš„æ˜¯ï¼šåœ¨ kubernetes 1.15 ä»¥å‰çš„ç‰ˆæœ¬éœ€è¦åœ¨æ‰§è¡Œkubectl applyæ—¶æ·»åŠ ä¸€ä¸ªå‚æ•°--validate=falseï¼Œå¦åˆ™åœ¨åˆ›å»º CustomResourceDefinition èµ„æºæ—¶ä¼šæ”¶åˆ°ä¸ x-kubernetes-preserve-unknown-fields å­—æ®µæœ‰å…³çš„éªŒè¯é”™è¯¯ã€‚
   helm å®‰è£… ä¾æ¬¡æ‰§è¡Œä¸‹è¿°å‘½ä»¤ï¼š</description>
    </item>
    
    <item>
      <title>åœ¨ Mac ä¸Šä½¿ç”¨ Docker è‡ªå¸¦çš„ Kubernetes</title>
      <link>https://mydream.ink/posts/cloud-native/kubernetes/use-kubernetes-from-docker-on-mac/</link>
      <pubDate>Fri, 12 Jul 2019 20:23:13 +0800</pubDate>
      
      <guid>https://mydream.ink/posts/cloud-native/kubernetes/use-kubernetes-from-docker-on-mac/</guid>
      <description>Mac å®‰è£… Docker çš„æ–¹æ³•ä¸å†èµ˜è¿°ï¼Œå¾ˆç®€å•ï¼Œå®˜æ–¹ä¸‹è½½å®‰è£…å³å¯ã€‚
å®‰è£…å®Œæˆåï¼Œkubectlçš„äºŒè¿›åˆ¶æ–‡ä»¶å°±å·²ç»å­˜åœ¨äº†ã€‚æˆ‘ä»¬ä»…éœ€è¦ä¸‹è½½é•œåƒï¼Œå¼€å¯ kubernetesã€‚
ä¸‹è½½é•œåƒ æŸ¥çœ‹ä¸€ä¸‹ä½ çš„ Docker å’Œ Kubernetes ç‰ˆæœ¬ï¼š
ä½¿ç”¨ä»¥ä¸‹è„šæœ¬ï¼Œè®°å¾—å°†é•œåƒç‰ˆæœ¬æ”¹æˆä½ æ‰€éœ€è¦çš„ğŸ
#!/bin/bash  set -e KUBE_VERSION=v1.10.11 KUBE_PAUSE_VERSION=3.1 ETCD_VERSION=3.1.12 DNS_VERSION=1.14.8 DOCKER_TOOL_VERSION=v0.4.12 GCR_URL=k8s.gcr.io ALIYUN_URL=registry.cn-hangzhou.aliyuncs.com/google_containers images=(kube-proxy-amd64:${KUBE_VERSION} kube-scheduler-amd64:${KUBE_VERSION} kube-controller-manager-amd64:${KUBE_VERSION} kube-apiserver-amd64:${KUBE_VERSION} pause-amd64:${KUBE_PAUSE_VERSION} etcd-amd64:${ETCD_VERSION} k8s-dns-sidecar-amd64:${DNS_VERSION} k8s-dns-kube-dns-amd64:${DNS_VERSION} k8s-dns-dnsmasq-nanny-amd64:${DNS_VERSION}) for image in ${images[@]} ; do docker pull ${ALIYUN_URL}/${image} docker tag ${ALIYUN_URL}/${image} ${GCR_URL}/${image} docker rmi ${ALIYUN_URL}/${image} done # æ‹‰å– Docker ç›¸å…³é•œåƒ docker pull docker/kube-compose-api-server:${DOCKER_TOOL_VERSION} docker pull docker/kube-compose-controller:${DOCKER_TOOL_VERSION} æ‰§è¡Œè¯¥è„šæœ¬ï¼Œå°†ä»é˜¿é‡Œé•œåƒåº“è·å¾—æ‰€éœ€é•œåƒã€‚
å¯åŠ¨ Kubernetes åŠŸèƒ½ æ‰“å¼€ Docker é…ç½®é¢æ¿ï¼Œè¯·è‡³å°‘å‹¾é€‰ Enable Kubernetes ä»¥å¼€å¯ Kubernetes æœåŠ¡ã€‚</description>
    </item>
    
    <item>
      <title>åœ¨ CentOS7 ä¸Šå®‰è£…æ–°ç‰ˆ Docker CEï¼ˆä½¿ç”¨å›½å†…æºï¼‰</title>
      <link>https://mydream.ink/posts/cloud-native/container/install-docker-on-centos7/</link>
      <pubDate>Fri, 12 Jul 2019 10:46:25 +0800</pubDate>
      
      <guid>https://mydream.ink/posts/cloud-native/container/install-docker-on-centos7/</guid>
      <description>å¸è½½è€ç‰ˆæœ¬ $ sudo yum remove docker \  docker-client \  docker-client-latest \  docker-common \  docker-latest \  docker-latest-logrotate \  docker-logrotate \  docker-engine å¦‚æœæ›¾ç»å®‰è£…è¿‡ï¼Œ/var/lib/docker/ä¸­ä¼šæœ‰åŸæ¥çš„é•œåƒã€å®¹å™¨ã€å·ä»¥åŠç½‘ç»œæ®‹ç•™ï¼Œå¦‚æœä¸éœ€è¦å¯å°†ä¹‹ä¸€å¹¶åˆ é™¤ã€‚
å®‰è£… Docker CE å®‰è£… Docker å›½å†…æº   å®‰è£… yum é…ç½®ç®¡ç†å·¥å…·
$ sudo yum install -y yum-utils \ device-mapper-persistent-data \ lvm2   å®‰è£…æ¸…åå¤§å­¦çš„ Docker å®‰è£…æºï¼ˆæœ¬ç½‘ç«™æœ‰æ•ˆï¼Œè¯¥å‘½ä»¤å°±æœ‰æ•ˆï¼‰
$ sudo yum-config-manager \ --add-repo \ https://mydream.ink/utils/container/docker-ce.repo ä½ å¯èƒ½ä¼šé‡åˆ°å¦‚ä¸‹é—®é¢˜ï¼š
 adding repo from: https://mydream.ink/utils/container/docker-ce.repo grabbing file https://mydream.ink/utils/container/docker-ce.repo to /etc/yum.</description>
    </item>
    
    <item>
      <title>ä½¿ç”¨ kubeadm å®‰è£… Kubernetes 1.10.0</title>
      <link>https://mydream.ink/posts/cloud-native/kubernetes/kubeadm/</link>
      <pubDate>Fri, 09 Mar 2018 00:00:00 +0000</pubDate>
      
      <guid>https://mydream.ink/posts/cloud-native/kubernetes/kubeadm/</guid>
      <description>kuberneteså¯ä»¥ä½¿ç”¨å¤šç§å®¹å™¨runtimeï¼Œæ­¤å¤„ä½¿ç”¨å½“å‰æœ€å¸¸è§çš„dockerã€‚
å®‰è£…docker åœ¨å„ç§æœºå™¨ä¸Šå®‰è£…dockerçš„æ–¹å¼ä¸åŒï¼Œæˆ‘æ›¾ç¿»è¯‘è¿‡ä¸€ç¯‡ubuntuå®‰è£…dockerçš„æ–‡ç« ï¼Œè¿˜æœ‰ä¸€äº›æ²¡æ¥çš„åŠç¿»è¯‘çš„ï¼Œå¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ã€‚æ¨èçš„dockerç‰ˆæœ¬ä¸ºv1.12ï¼Œv1.11, v1.13 å’Œ 17.03 ä¹Ÿè¡Œï¼Œå…¶å®ƒçš„å®˜æ–¹å°±æ²¡æµ‹è¯•è¿‡äº†ï¼Œä¸è¿‡æˆ‘ä½¿ç”¨å½“å‰æœ€æ–°çš„v18.03ä¹Ÿè¡Œã€‚
dockerå®˜æ–¹  ä½¿ç”¨Ubuntuå®‰è£…docker-ce Macå’ŒWindowsæ¡Œé¢å®‰è£…docker-ce  ä¸‹è½½Macç‰ˆæœ¬çš„docker-ceï¼Œæ‰§è¡Œå³å®‰è£… ä¸‹è½½Windowsç‰ˆæœ¬çš„docker-ceï¼Œæ‰§è¡Œå³å¯å®‰è£…   CentOSå®‰è£…docker-ce Fedoraå®‰è£…docker-ce äºŒè¿›åˆ¶å®‰è£…æ–¹å¼  kubernetesæ¨è   Ubuntu/Debian/HypriotOS ä»Ubuntuçš„åº“å®‰è£…
apt-get update apt-get install -y docker.io ä½¿ç”¨dockeråº“å®‰è£…v17.03
apt-get update apt-get install -y \  apt-transport-https \  ca-certificates \  curl \  software-properties-common curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add - add-apt-repository \  &amp;#34;deb https://download.docker.com/linux/$(. /etc/os-release; echo &amp;#34;$ID&amp;#34;)\ $(lsb_release -cs)\ stable&amp;#34; apt-get update &amp;amp;&amp;amp; apt-get install -y docker-ce=$(apt-cache madison docker-ce | grep 17.</description>
    </item>
    
    <item>
      <title>LXCä»‹ç»</title>
      <link>https://mydream.ink/posts/cloud-native/container/lxc1/</link>
      <pubDate>Sat, 11 Nov 2017 08:56:06 +0800</pubDate>
      
      <guid>https://mydream.ink/posts/cloud-native/container/lxc1/</guid>
      <description>ä»€ä¹ˆæ˜¯LXCï¼Ÿ LXCæ˜¯Linuxå†…æ ¸ä¸­æ‹¥æœ‰å®¹å™¨åŠŸèƒ½çš„ç”¨æˆ·ç©ºé—´æ¥å£ã€‚ é€šè¿‡å¼ºå¤§çš„APIå’Œç®€å•çš„å·¥å…·ï¼Œå®ƒå¯ä»¥è®©Linuxç”¨æˆ·è½»æ¾åˆ›å»ºå¹¶ç®¡ç†ç³»ç»Ÿæˆ–åº”ç”¨ç¨‹åºå®¹å™¨ã€‚
ç‰¹å¾ å½“å‰çš„LXCä½¿ç”¨ä»¥ä¸‹çš„å†…æ ¸ç‰¹æ€§æ¥å°è£…è¿›ç¨‹
 Kernel namespaces (ipc, uts, mount, pid, network and user) Apparmor and SELinux profiles Seccomp policies Chroots (using pivot_root) Kernel capabilities CGroups (control groups)  LXCå®¹å™¨é€šå¸¸è¢«è®¤ä¸ºæ˜¯chrootå’Œä¸€ä¸ªå®Œæ•´çš„è™šæ‹Ÿæœºã€‚ LXCçš„ç›®æ ‡æ˜¯å°½å¯èƒ½åˆ›é€ ä¸€ä¸ªç¯å¢ƒ åˆ°ä¸€ä¸ªæ ‡å‡†çš„Linuxå®‰è£…ï¼Œä½†ä¸éœ€è¦å•ç‹¬çš„å†…æ ¸ã€‚
ç»„ä»¶ LXCç›®å‰ç”±å‡ ä¸ªå•ç‹¬çš„ç»„ä»¶ç»„æˆï¼š
 liblxcåº“ APIçš„å‡ ç§è¯­è¨€ç»‘å®š  python3 (in-tree, long term support in 1.0.x and 2.0.x) lua (in tree, long term support in 1.0.x and 2.0.x) Go ruby python2 Haskell   ä¸€å¥—æ§åˆ¶å®¹å™¨çš„æ ‡å‡†å·¥å…· åˆ†å‘å®¹å™¨æ¨¡æ¿  </description>
    </item>
    
    <item>
      <title>LXCç®€ä»‹</title>
      <link>https://mydream.ink/posts/cloud-native/container/lxc0/</link>
      <pubDate>Sun, 05 Nov 2017 08:56:09 +0800</pubDate>
      
      <guid>https://mydream.ink/posts/cloud-native/container/lxc0/</guid>
      <description>LXC LXCæ˜¯è‘—åçš„ç»è¿‡ä¸¥æ ¼æµ‹è¯•çš„åº•å±‚Linuxå®¹å™¨è¿è¡Œåº“ã€‚ä»2008å¹´å¼€å§‹å‘å±•ï¼Œç°å·²åœ¨ä¸–ç•Œå„åœ°çš„å…³é”®ç”Ÿäº§ç¯å¢ƒä¸­å¾—åˆ°è¯æ˜ã€‚å…¶ä¸­ä¸€äº›æ ¸å¿ƒè´¡çŒ®è€…æ˜¯å¸®åŠ©åœ¨Linuxå†…æ ¸ä¸­å®ç°å„ç§çŸ¥åé›†è£…ç®±åŠŸèƒ½çš„äººå‘˜ã€‚
ç³»ç»Ÿå®¹å™¨ LXCçš„ä¸»è¦é‡ç‚¹æ˜¯ç³»ç»Ÿå®¹å™¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæä¾›å°½å¯èƒ½æ¥è¿‘VMä½†æ²¡æœ‰è¿è¡Œå•ç‹¬å†…æ ¸å¹¶æ¨¡æ‹Ÿæ‰€æœ‰ç¡¬ä»¶çš„å¼€é”€çš„å®¹å™¨ã€‚ è¿™æ˜¯é€šè¿‡å†…æ ¸å®‰å…¨åŠŸèƒ½ï¼ˆå¦‚å‘½åç©ºé—´ï¼Œå¼ºåˆ¶è®¿é—®æ§åˆ¶å’Œæ§åˆ¶ç»„åˆï¼‰å®ç°çš„ã€‚
éç‰¹æƒå®¹å™¨ éç‰¹æƒå®¹å™¨æ˜¯æ²¡æœ‰ä»»ä½•æƒé™è¿è¡Œçš„å®¹å™¨ã€‚è¿™éœ€è¦å¯¹å†…æ ¸ä¸­è¿è¡Œå®¹å™¨çš„ç”¨æˆ·åç©ºé—´çš„æ”¯æŒã€‚ç”¨æˆ·å‘½åç©ºé—´åˆå¹¶åˆ°ä¸»çº¿å†…æ ¸ä¹‹åï¼ŒLXCæ˜¯ç¬¬ä¸€ä¸ªæ”¯æŒéç‰¹æƒå®¹å™¨çš„è¿è¡Œåº“ã€‚ å®è´¨ä¸Šï¼Œç”¨æˆ·åç©ºé—´éš”ç¦»ç»™å®šçš„UIDå’ŒGIDé›†åˆã€‚è¿™é€šè¿‡åœ¨ä¸»æœºä¸Šçš„ä¸€ç³»åˆ—UIDå’ŒGIDä¹‹é—´å»ºç«‹åˆ°å®¹å™¨ä¸­UIDå’ŒGIDçš„ä¸åŒï¼ˆéç‰¹æƒï¼‰èŒƒå›´ä¹‹é—´çš„æ˜ å°„æ¥å®ç°ã€‚å†…æ ¸å°†ä»¥è¿™æ ·ä¸€ç§æ–¹å¼è½¬æ¢æ­¤æ˜ å°„ï¼Œå³åœ¨å®¹å™¨å†…éƒ¨ï¼Œæ‰€æœ‰UIDå’ŒGIDæŒ‰ç…§æ‚¨æœŸæœ›çš„ä»ä¸»æœºæ˜¾ç¤ºï¼Œè€Œåœ¨ä¸»æœºä¸Šï¼Œè¿™äº›UIDå’ŒGIDå®é™…ä¸Šæ˜¯æ— ç‰¹æƒçš„ã€‚ä¾‹å¦‚ï¼Œåœ¨å®¹å™¨å†…ä½œä¸ºUIDå’ŒGID 0è¿è¡Œçš„è¿›ç¨‹å¯èƒ½åœ¨ä¸»æœºä¸Šæ˜¾ç¤ºä¸ºUIDå’ŒGID 100000ã€‚å¯ä»¥ä»ç›¸åº”çš„ç”¨æˆ·å‘½åç©ºé—´æ‰‹å†Œé¡µä¸­æ”¶é›†å®ç°å’Œå·¥ä½œç»†èŠ‚ã€‚ ç”±äºéç‰¹æƒå®¹å™¨æ˜¯ä¸€ç§å®‰å…¨å¢å¼ºåŠŸèƒ½ï¼Œå› æ­¤å®ƒä»¬è‡ªç„¶ä¼šå—åˆ°å†…æ ¸å¼ºåˆ¶æ‰§è¡Œçš„ä¸€äº›é™åˆ¶ã€‚ä¸ºäº†æä¾›ä¸€ä¸ªåŠŸèƒ½é½å…¨çš„éç‰¹æƒå®¹å™¨LXCä¸3ä¸ªsetuidä»£ç äº¤äº’ï¼š
 lxc-user-nicï¼ˆsetuidå¸®åŠ©å™¨åˆ›å»ºä¸€ä¸ªvethå¯¹ï¼Œå¹¶åœ¨ä¸»æœºä¸Šæ¡¥æ¥å®ƒï¼‰ newuidmapï¼ˆä»shawdowåº“ä¸­ï¼Œè®¾ç½®ä¸€ä¸ªuidæ˜ å°„ï¼‰ newgidmapï¼ˆä»shawdowåº“ä¸­ï¼Œè®¾ç½®ä¸€ä¸ªgidæ˜ å°„ï¼‰  ä¸€åˆ‡éƒ½æ˜¯ä»¥æ‚¨è‡ªå·±çš„ç”¨æˆ·èº«ä»½è¿è¡Œï¼Œä¹Ÿå¯ä»¥ä½œä¸ºç”¨æˆ·æ‹¥æœ‰çš„uidè¿è¡Œã€‚ ä¸€èˆ¬æ¥è¯´ï¼ŒLXCçš„ç›®æ ‡æ˜¯åˆ©ç”¨å†…æ ¸ä¸­å¯ç”¨çš„æ¯ä¸ªå®‰å…¨åŠŸèƒ½ã€‚è¿™æ„å‘³ç€LXCçš„é…ç½®ç®¡ç†å°†ä½¿ç»éªŒä¸°å¯Œçš„ç”¨æˆ·æ ¹æ®è‡ªå·±çš„éœ€è¦å¯¹LXCè¿›è¡Œå¤æ‚çš„è°ƒæ•´ã€‚ æœ‰å…³LXCå®‰å…¨æ€§çš„æ›´è¯¦ç»†çš„ä»‹ç»å¯ä»¥åœ¨ä»¥ä¸‹é“¾æ¥ä¸­æ‰¾åˆ°ï¼š
 https://linuxcontainers.org/lxc/security/  ç§»é™¤ç‰¹æƒ LXCåœ¨æ²¡æœ‰æ­£ç¡®çš„é…ç½®è¿™äº›å·¥å…·çš„æƒ…å†µä¸‹æ˜¯å¯ä»¥è¿è¡Œçš„ã€‚åªä¸è¿‡ä½ è¿™ç§å®¹å™¨çš„ç”¨é€”é€šå¸¸æ˜¯éå¸¸æœ‰é™çš„ã€‚è¿™é‡Œçªå‡ºä¸¤ä¸ªæœ€å¸¸è§çš„é—®é¢˜ï¼š
 ç½‘ç»œï¼šæ²¡æœ‰ä¾èµ–ä¸€ä¸ªsetuidå¸®åŠ©å™¨ä¸ºéç‰¹æƒç”¨æˆ·è®¾ç½®é€‚å½“çš„ç½‘ç»œè®¾å¤‡ï¼ˆå‚è§LXCçš„lxc-user-nicäºŒè¿›åˆ¶æ–‡ä»¶ï¼‰ï¼Œå”¯ä¸€çš„é€‰æ‹©æ˜¯ä¸ä¸»æœºå…±äº«ç½‘ç»œå‘½åç©ºé—´ã€‚è™½ç„¶åŸåˆ™ä¸Šåº”è¯¥æ˜¯å®‰å…¨çš„ï¼Œä½†å…±äº«ä¸»æœºçš„ç½‘ç»œå‘½åç©ºé—´ä»ç„¶æ˜¯å‡å°‘éš”ç¦»çš„ä¸€ä¸ªæ­¥éª¤ï¼Œå¹¶å¢åŠ æ”»å‡»å‘é‡ã€‚æ­¤å¤–ï¼Œå½“ä¸»æœºå’Œå®¹å™¨å…±äº«ç›¸åŒçš„ç½‘ç»œå‘½åç©ºé—´æ—¶ï¼Œå†…æ ¸å°†æ‹’ç»ä»»ä½•sysfsæŒ‚æ¥ã€‚è¿™é€šå¸¸æ„å‘³ç€å®¹å™¨å†…çš„initäºŒè¿›åˆ¶æ–‡ä»¶å°†æ— æ³•æ­£ç¡®å¯åŠ¨ã€‚ ç”¨æˆ·å‘½åç©ºé—´ï¼šå¦‚ä¸Šæ‰€è¿°ï¼Œç”¨æˆ·åç©ºé—´æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„å®‰å…¨æ€§å¢å¼ºã€‚ä½†æ˜¯ï¼Œä¸ä¾èµ–ç‰¹æƒå¸®åŠ©è€…ï¼Œä¸»æœºä¸Šæ— æƒé™çš„ç”¨æˆ·åªèƒ½å°†è‡ªå·±çš„UIDæ˜ å°„åˆ°å®¹å™¨ä¸­ã€‚ç„¶è€Œï¼Œæ ‡å‡†çš„POSIXç³»ç»Ÿéœ€è¦65536ä¸ªUIDå’ŒGIDæ¥ä¿è¯å®Œæ•´çš„åŠŸèƒ½ã€‚  é…ç½® LXCé€šè¿‡ä¸€äº›ç®€å•çš„å…³é”®å­—é…ç½®ï¼Œä¾‹å¦‚ï¼š
 lxc.rootfs.path lxc.mount.entry  LXCé€šè¿‡ä½¿ç”¨å•ç‚¹å‘½åç©ºé—´é…ç½®å…³é”®å­—ã€‚è¿™æ„å‘³ç€å¤æ‚çš„é…ç½®å…³é”®å­—ï¼ˆå¦‚lxc.net.0ï¼‰ä¼šå±•ç¤ºå„ç§å­é¡¹ï¼Œä¾‹å¦‚lxc.net.0.typeï¼Œlxc.net.0.linkï¼Œlxc.net.0.ipv6.addressç­‰ä¸€äº›æ›´ç²¾ç»†çš„é…ç½®ã€‚ LXCè¢«ç”¨ä½œLXDçš„é»˜è®¤è¿è¡Œåº“ï¼ŒLXDæ˜¯å®¹å™¨ç®¡ç†ç¨‹åºï¼Œå®ƒæš´éœ²å‡ºè®¾è®¡è‰¯å¥½ä¸”ç¨³å®šçš„REST-apiã€‚
å†…æ ¸éœ€æ±‚ LXCåœ¨2.6.32ä»¥ä¸Šçš„ä»»ä½•å†…æ ¸ä¸Šè¿è¡Œã€‚æ‰€æœ‰å®ƒéœ€è¦çš„æ˜¯ä¸€ä¸ªåŠŸèƒ½Cç¼–è¯‘å™¨ã€‚ LXCé€‚ç”¨äºæä¾›å¿…è¦å†…æ ¸åŠŸèƒ½çš„æ‰€æœ‰æ¶æ„ã€‚è¿™åŒ…æ‹¬ï¼ˆä½†ä¸é™äºï¼‰ï¼š
 i686 x86_64 ppc,ppc64,ppc64le s390x armvl7,arm64  LXCè‡³å°‘è¿˜æ”¯æŒä»¥ä¸‹Cæ ‡å‡†åº“ï¼š
 glibc musl bionic(Android&amp;rsquo;s libc)  å‘åå…¼å®¹ LXCä¸€ç›´ä¸“æ³¨äºå¼ºå¤§çš„å‘åå…¼å®¹æ€§ã€‚äº‹å®ä¸Šï¼ŒAPIä»1.0.0ç‰ˆèµ·æ²¡æœ‰è¢«ç ´åã€‚ä¸»LXCç›®å‰å¤„äºç‰ˆæœ¬2ã€‚</description>
    </item>
    
    <item>
      <title>Ubuntuå®‰è£… Docker ç¤¾åŒºç‰ˆ</title>
      <link>https://mydream.ink/posts/cloud-native/container/install-docker-on-ubuntu/</link>
      <pubDate>Sun, 22 Oct 2017 08:54:08 +0800</pubDate>
      
      <guid>https://mydream.ink/posts/cloud-native/container/install-docker-on-ubuntu/</guid>
      <description>å‡†å¤‡ ç³»ç»Ÿè¦æ±‚ è¦å®‰è£…Docker CEï¼Œæˆ‘ä»¬éœ€è¦è¿™äº›64ä½ç‰ˆæœ¬çš„Ubuntuï¼š
 Artful 17.10 (Docker CE 17.11 Edge and higher only) Zesty 17.04 Xenial 16.04 (LTS) Trusty 14.04 (LTS)  åœ¨Ubuntu x86_64ã€armhfã€s390xï¼ˆIBM Zï¼‰å’Œppc64leï¼ˆIBM Powerï¼‰æ¶æ„ä¸Šæ”¯æŒDocker CEã€‚
 ppc64leå’Œs390xé™åˆ¶ï¼šIBM Zå’ŒPowerä½“ç³»ç»“æ„çš„è½¯ä»¶åŒ…ä»…åœ¨Ubuntu XenialåŠæ›´é«˜ç‰ˆæœ¬ä¸Šå¯ç”¨ã€‚
 å¸è½½æ—§ç‰ˆæœ¬ è€ç‰ˆæœ¬çš„Dockerè¢«ç§°ä¸ºdockeræˆ–è€…docker-engineã€‚å¦‚æœå®‰è£…äº†è¿™äº›ï¼Œè¯·å°†å…¶å¸è½½ï¼š
sudo apt-get remove docker docker-engine docker.io  å¦‚æœapt-getæŠ¥å‘Šæ²¡æœ‰å®‰è£…è¿™äº›è½¯ä»¶åŒ…ï¼Œåˆ™å¯ä»¥ç›´æ¥è·³è¿‡è¿™ä¸€æ­¥ã€‚
/var/lib/docker/çš„å†…å®¹ï¼ˆåŒ…æ‹¬æ˜ åƒï¼Œå®¹å™¨ï¼Œå·å’Œç½‘ç»œï¼‰å°†è¢«ä¿ç•™ã€‚ Docker CEåŒ…ç°åœ¨ç§°ä¸ºdocker-ceã€‚
å®‰è£…Docker CE æ‚¨å¯ä»¥æ ¹æ®æ‚¨çš„éœ€è¦ä»¥ä¸åŒçš„æ–¹å¼å®‰è£…Docker CEï¼š
 å¤§å¤šæ•°ç”¨æˆ·è®¾ç½®Dockerçš„å­˜å‚¨åº“å¹¶ä»ä¸­è¿›è¡Œå®‰è£…ï¼Œä»¥æ–¹ä¾¿å®‰è£…å’Œå‡çº§ä»»åŠ¡ã€‚è¿™æ˜¯æ¨èçš„æ–¹æ³•ã€‚ æœ‰äº›ç”¨æˆ·ä¸‹è½½debè½¯ä»¶åŒ…æ‰‹åŠ¨å®‰è£…ï¼Œå¹¶å®Œå…¨æ‰‹åŠ¨ç®¡ç†å‡çº§ã€‚è¿™å¾ˆé€‚åˆåœ¨è¯¸å¦‚æ²¡æœ‰äº’è”ç½‘è®¿é—®çš„å°é—­ç³»ç»Ÿä¸Šå®‰è£…Dockerã€‚ åœ¨æµ‹è¯•å’Œå¼€å‘ç¯å¢ƒä¸­ï¼Œæœ‰äº›ç”¨æˆ·é€‰æ‹©ä½¿ç”¨è‡ªåŠ¨ä¾¿æ·è„šæœ¬æ¥å®‰è£…Dockerã€‚  ä½¿ç”¨è½¯ä»¶ä»“åº“å®‰è£… é¦–æ¬¡åœ¨æ–°çš„ä¸»æœºä¸Šå®‰è£…Docker CEä¹‹å‰ï¼Œéœ€è¦è®¾ç½®Dockerè½¯ä»¶ä»“åº“ã€‚ä¹‹åï¼Œæ‚¨å¯ä»¥ä»è¯¥åº“å®‰è£…å’Œæ›´æ–°Dockerã€‚
è®¾ç½®è½¯ä»¶ä»“åº“   æ›´æ–°aptåŒ…ç´¢å¼•ï¼š
sudo apt-get update    å®‰è£…è½¯ä»¶åŒ…ä»¥å…è®¸apté€šè¿‡HTTPSä½¿ç”¨å­˜å‚¨åº“ï¼š
sudo apt-get install \ apt-transport-https \ ca-certificates \ curl \ software-properties-common    æ·»åŠ Dockerçš„å®˜æ–¹GPGå¯†é’¥ï¼š</description>
    </item>
    
  </channel>
</rss>
